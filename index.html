<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Painel Operador | LR Empr√©stimo</title>

<style>
body{
  margin:0;
  font-family:system-ui,Arial;
  background:#f2f4f7;
}
.container{
  max-width:900px;
  margin:30px auto;
  background:#fff;
  padding:20px;
  border-radius:10px;
  box-shadow:0 10px 25px rgba(0,0,0,.1);
}
.hidden{display:none}
h2{margin-top:0}
textarea,input,button{
  width:100%;
  padding:12px;
  margin-top:10px;
  font-size:14px;
}
button{
  border:0;
  border-radius:6px;
  cursor:pointer;
}
.btn-login{background:#333;color:#fff}
.btn-aplicar{background:#1c9bd6;color:#fff}
.btn-whats{background:#25d366;color:#fff;padding:6px 10px;font-size:13px}
table{
  width:100%;
  border-collapse:collapse;
  margin-top:15px;
}
th,td{
  border:1px solid #ddd;
  padding:8px;
  font-size:13px;
  text-align:left;
}
th{background:#eee}
footer{
  text-align:center;
  font-size:12px;
  color:#666;
  margin-top:20px;
}
</style>
</head>

<body>

<!-- LOGIN -->
<div class="container" id="loginBox">
  <h2>üîê Login do Operador</h2>
  <input id="user" placeholder="Usu√°rio">
  <input id="pass" type="password" placeholder="Senha">
  <button class="btn-login" onclick="login()">Entrar</button>
</div>

<!-- PAINEL -->
<div class="container hidden" id="painel">

  <h2>üìã Lista de Contatos ‚Äì LR Empr√©stimo</h2>

  <textarea id="lista" rows="6" placeholder="Cole TODOS os n√∫meros aqui (qualquer formato)"></textarea>

  <textarea id="mensagem" rows="3">
Ol√°! Aqui √© da LR Empr√©stimo.
Temos uma oportunidade de cr√©dito dispon√≠vel para voc√™.
Posso te explicar?
  </textarea>

  <input id="operador" placeholder="Nome do operador">

  <button class="btn-aplicar" onclick="aplicar()">Aplicar</button>

  <table>
    <thead>
      <tr>
        <th>N√∫mero</th>
        <th>A√ß√£o</th>
      </tr>
    </thead>
    <tbody id="tabela"></tbody>
  </table>

</div>

<footer>
LR Empr√©stimo ¬© 2026
</footer>

<script>
const API = "https://api-emprestimo-operador.onrender.com";

function login(){
  if(user.value==="adminglps" && pass.value==="admin1533"){
    loginBox.classList.add("hidden");
    painel.classList.remove("hidden");
  }else{
    alert("Usu√°rio ou senha incorretos");
  }
}

function aplicar(){
  tabela.innerHTML = "";

  const numeros = lista.value
    .split(/\s+/)
    .map(n => n.replace(/\D/g,""))
    .filter(n => n.length >= 10);

  numeros.forEach(numero => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${numero}</td>
      <td>
        <button class="btn-whats" onclick="contatar('${numero}')">
          WhatsApp
        </button>
      </td>
    `;
    tabela.appendChild(tr);
  });
}

async function contatar(numero){
  const msg = mensagem.value;

  // salva na API
  await fetch(API+"/enviar",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({
      operador: operador.value || "Operador",
      numero: numero,
      mensagem: msg
    })
  });

  const texto = encodeURIComponent(msg);
  window.open(
    `https://api.whatsapp.com/send?phone=${numero}&text=${texto}`,
    "_blank"
  );
}
</script>

</body>
</html>
